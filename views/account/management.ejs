<h1><%= title %></h1>

<% if (notice && notice.length) { %>
  <div class="notice" role="status">
    <p><%= notice[0] %></p>
  </div>
<% } %>

<h2>Welcome <%= accountData.account_firstname %></h2>

<p><a href="/account/update/<%= accountData.account_id %>">Update Account Information</a></p>

<% if (accountData.account_type === 'Employee' || accountData.account_type === 'Admin') { %>
  <h3>Inventory Management</h3>
  <p><a href="/inv/">Manage Inventory</a></p>
<% } %>

<h3>My Favorite Vehicles</h3>
<% if (favorites && favorites.length > 0) { %>
  <table class="reviews-table">
    <thead>
      <tr>
        <th>Vehicle</th>
        <th>Price</th>
        <th>Saved On</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% favorites.forEach(function(favorite) { %>
        <tr>
          <td>
            <a href="/inv/detail/<%= favorite.inv_id %>"><%= favorite.inv_year %> <%= favorite.inv_make %> <%= favorite.inv_model %></a>
          </td>
          <td>
            <%= new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(favorite.inv_price) %>
          </td>
          <td>
            <%= new Date(favorite.favorite_date).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'short',
              day: 'numeric'
            }) %>
          </td>
          <td>
            <form action="/favorite/remove" method="post" class="inline-form">
              <input type="hidden" name="inv_id" value="<%= favorite.inv_id %>">
              <input type="hidden" name="return_to" value="/account/">
              <button type="submit" class="btn-link">Remove</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } else { %>
  <p>You have not saved any favorite vehicles yet.</p>
<% } %>

<h3>My Reviews</h3>
<% if (reviews && reviews.length > 0) { %>
  <table class="reviews-table">
    <thead>
      <tr>
        <th>Vehicle</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% reviews.forEach(function(review) { %>
        <tr>
          <td>
            Reviewed the <%= review.inv_year %> <%= review.inv_make %> <%= review.inv_model %>
          </td>
          <td>
            <%= new Date(review.review_date).toLocaleDateString('en-US', { 
              year: 'numeric', 
              month: 'short', 
              day: 'numeric' 
            }) %>
          </td>
          <td>
            <a href="/review/edit/<%= review.review_id %>">Edit</a> | 
            <a href="/review/delete/<%= review.review_id %>">Delete</a>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } else { %>
  <p>You have not written any reviews yet.</p>
<% } %>
